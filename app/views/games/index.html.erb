<h2>Open Games</h2>
<table class='table table-striped'>
  <thead>
    <tr>
      <th>Game Name</th>
      <th>Time Created</th>
      <th>Player 1</th>
      <th>Player 2</th>
      <th>Joinable </th>
    </tr>
  </thead>
  <tbody>
    <% @games.each do |game| %>
    <tr>
      <td><%= game.name %></td>
      <td><%= game.created_at %></td>
      <td><%= game.player0 %></td>
      <td>
      <% if game.player1 == nil %>
        *Open*
      <% else %>
        <%= game.player1 %>
      <% end %>
      </td>
      <td>
        <% if current_user != nil %>
          <% if current_user.username == game.player0 or \
              current_user.username == game.player1 %>
            <%= link_to 'Resume', game, :class => "btn btn-success" %>
          <% elsif game.player1 == nil %>
            <%= link_to 'Join', game, :class => "btn btn-success" %>
          <% elsif (!game.code0.nil? and !game.code1.nil?) %>
            <%= link_to 'Watch', game_path(game)+'/watch', :class => "btn btn-info" %>
          <% else %>
            *Game full!*
          <% end %>
        <% elsif (!game.code0.nil? and !game.code1.nil?) %>
          <%= link_to 'Watch', game_path(game)+'/watch', :class => "btn btn-info" %>
        <% else %>
          Sign in!
        <% end %>
      </td>
    </tr>
    <% end %>
    <% if @games.empty? %>
      <tr><td colspan="5">No games are currently open.</td></tr>
    <% end %>
  </tbody>
</table>
<%= link_to 'Create Game', new_game_path, :class => "btn btn-inverse" %>
<%= link_to 'Delete All Games', {:action => 'delete_all_games'}, :class => "btn btn-danger" %>
